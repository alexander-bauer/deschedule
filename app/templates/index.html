{% extends "base.html" %}

{% block head %}
{{ super() }}
<title>Deschedule</title>
{% endblock %}

{% block scripts %}
{{ super() }}

<script type="text/javascript">

$(document).ready(function() {
  $('ul.schools li a').click(function() {
    $('#school_dropdown_label').html($(this).html());
  });
});

$(document).ready(function() {
  fill_all_sections('umbc', 'spring2016', function(resp) {
    $('.section').click(function(event) {
      $(this).toggleClass('section-selected');
    });
    $('.section').click(function() {
      section_ids = []
      $('.section-selected').each(function(index, section) {
        section_ids.push($(this).attr('data-classcode') + '.' + $(this).attr('data-number'));
      });

      to_ical = $('#to_ical');
      ical_link = $('#ical_link');
      if(section_ids.length > 0) {
        to_ical.removeAttr('disabled');
        ical_link.removeAttr('disabled');
        ical_link.attr('value', window.location.href +
            construct_schedule_url('umbc', 'spring2016', section_ids));
      } else {
        to_ical.attr('disabled', 'disabled');
        ical_link.attr('disabled', 'disabled');
        ical_link.attr('value', '');
      }
    });
  });
});

$(document).ready(function() {
  $('#to_ical').click(function(event) {
    section_ids = []
    $('.section-selected').each(function(index, section) {
      section_ids.push($(this).attr('data-classcode') + '.' + $(this).attr('data-number'));
    });

    location.href = construct_schedule_url('umbc', 'spring2016', section_ids);
  });
});

$(document).ready(function() {
  $('#ical_link').focus(function() {
    $(this).select();
  });
});
</script>
{% endblock %}

{% block content %}
{{ super() }}
<div id="title" class="mui--text-center">
  <div class="mui--text-display3">Deschedule</div>
  <div class="mui--text-display1">Simplify your Academic Calendar</div>
</div>

<div id="description">
  Deschedule is a free web service that collects lists of University class
  schedules, and generates event calendars that can be imported into any other
  calendar application. To use it, you don't need to make an account or log in.
  Enter your school, the classes (and section numbers) that you are in, and import
  the resulting URL into your calendar app.
</div>

<div id="control-box">
  <div class="mui--text-center">
    <button id="to_ical" class="mui-btn mui-btn--raised" disabled>Make iCalendar</button>
  </div>
  <div class="mui--text-center mui-textfield">
    <input id="ical_link" type="text" readonly="hi" disabled></input>
  </div>
</div>

<ul id="sections-selected"></ul>
<div id="results">
  <div class="loader fade">
    <div class="loading">
      <div class="spinner">
        <div class="mask">
          <div class="loading-circle"></div>
        </div>
      </div>
    </div>
  </div>
  <ul id="sections"></ul>
</div>

{% endblock %}
